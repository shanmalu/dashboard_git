<!doctype html>
<html lang="ko">
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>826.ì±„ë„8ê°œ.ì¡°ëª…ì˜¨ë„ìŠµë„</title>
<style>
  body { font-family: system-ui, sans-serif; margin: 12px; background:#f7f7f9; }
  .grid { display:grid; gap:12px; grid-template-columns: repeat(auto-fit, minmax(220px,1fr)); }
  .card { background:white; border-radius:14px; padding:8px; box-shadow:0 6px 12px rgba(0,0,0,.06); }
  .title { font-size:16px; margin-bottom:6px; }
  .value { font-size:16px; font-weight:700; margin-bottom:6px; }
  .label { color:#666; font-size:14px; margin-bottom:2px; }
  .time { font-size:14px; color:#444; margin:2px 0; }
  
  header { display:flex;  align-items: center;
    margin-bottom:10px; }
  .header-box { width: 50%;  text-align: center;  }
  
 h1 { font-size:16px; margin:0;}
  .clock { font-size:16px; color:#333; }
</style>
  
<body>
<header>
   <div class="header-box"><h1> ğŸ“Š ì‹¤ì‹œê°„&nbsp;ì¸¡ì •ì¹˜</h1></div>
   <div class="header-box"><div class="clock" id="clock">--:--:--</div></div>
</header>

<div class="grid"> 
      
  <div class="card" id="naver1">
    <div class="title">ğŸŒ¿na.c1.ì»¨í…Œë„ˆ.e5i8</div>
    <div class="value" id="n1_lux">-- Lx</div>
    <div class="value" id="n1_temp">-- â„ƒ</div>
    <div class="value" id="n1_hum">-- %</div>
    <div class="time" id="n1_time">ì‹œê°„: --</div>
  </div>
    
   <div class="card" id="naver3)">
    <div class="title">ğŸŒ¿na.c3.ì‹¤ì™¸.e7i39</div>
    <div class="value" id="n3_lux">-- Lx</div>
    <div class="value" id="n3_temp">-- â„ƒ</div>
    <div class="value" id="n3_hum">-- %</div>
    <div class="time" id="n3_time">ì‹œê°„: --</div>
  </div>
  
  <div class="card" id="naver2">
    <div class="title">ğŸŒ¿na.c2.ë‚œì‹¤(ìƒ).e6i31</div>
    <div class="value" id="n2_lux">-- Lx</div>
    <div class="value" id="n2_temp">-- â„ƒ</div>
    <div class="value" id="n2_hum">-- %</div>
    <div class="time" id="n2_time">ì‹œê°„: --</div>
  </div>

  <div class="card" id="naver4">
    <div class="title">ğŸ¢na.c4.ë‚œì‹¤(í•˜).e4i97</div>
    <div class="value" id="n4_lux">-- Lx</div>
    <div class="value" id="n4_temp">-- â„ƒ</div>
    <div class="value" id="n4_hum">-- %</div>
    <div class="time" id="n4_time">ì‹œê°„: --</div>
  </div> 
  
  <div class="card" id="gma3">
    <div class="title">ğŸŒ¿gm.c3.ë‚œíšŒìˆ˜.e3i23</div>
    <div class="value" id="g3_lux">-- Lx</div>
    <div class="value" id="g3_temp">-- â„ƒ</div>
    <div class="value" id="g3_hum">-- %</div>
    <div class="time" id="g3_time">ì‹œê°„: --</div>
  </div>       

  <div class="card" id="gma2">
    <div class="title">ğŸ gm.c2.ì»¨íšŒìˆ˜.e2i4</div>
    <div class="value" id="g2_lux">-- Lx</div>
    <div class="value" id="g2_temp">-- â„ƒ</div>
    <div class="value" id="g2_hum">-- %</div>
    <div class="time" id="g2_time">ì‹œê°„: --</div>
  </div>

  <div class="card" id="gma1">
    <div class="title">ğŸ¢gm.c1.ê¹€í¬1.e1i43</div>
    <div class="value" id="g1_lux">-- Lx</div>
    <div class="value" id="g1_temp">-- â„ƒ</div>
    <div class="value" id="g1_hum">-- %</div>
    <div class="time" id="g1_time">ì‹œê°„: --</div>
  </div>
  
  <div class="card" id="gma4">
    <div class="title">ğŸ¢gm.c4.ê¹€í¬4.0000</div>
    <div class="value" id="g4_lux">-- Lx</div>
    <div class="value" id="g4_temp">-- â„ƒ</div>
    <div class="value" id="g4_hum">-- %</div>
    <div class="time" id="g4_time">ì‹œê°„: --</div>
  </div>
   
</div> 
   <div class="label">File: dashboard_826.  </div>

<script>
const CHANNELS = {
  gma1:   { id: 3018897, read_key: "8LPG5E9FMQBPMT95" },
  gma2:   { id: 3016776, read_key: "0GYPNOPAHTLWY2FU" },
  gma3:   { id: 3020435, read_key: "DQW527FW43D0I249" },
  gma4:   { id: 3015582, read_key: "4KTWZ5HV3YTL7JE6" },
  naver1: { id: 3047574, read_key: "3ZULDVNI47LM2XUU" },
  naver2: { id: 3047580, read_key: "589U5K9LQDG7MMZO" },
  naver3: { id: 3047588, read_key: "7JQ621N43OOEKA13" },
  naver4: { id: 3047591, read_key: "WCREQ2P18WN27TUP" }
 };

function qsel(id){ return document.getElementById(id); }
function pad(n) { return n.toString().padStart(2, '0'); }

function fmtDateTime(dateStr) {
  try {
    const d = new Date(dateStr);
    const y = String(d.getFullYear()).slice(2); 
    const m = d.getMonth() + 1;
    const day = d.getDate();
    const h = pad(d.getHours());
    const min = pad(d.getMinutes());
    const s = pad(d.getSeconds());
    return `${y}.${m}.${day}. ${h}:${min}:${s}`; 
   }
  catch (e) {
    return dateStr; }
 }

function fmtClockTime() {
  const d = new Date();
  const y = String(d.getFullYear()).slice(2);
  const m = d.getMonth() + 1;
  const day = d.getDate();
  const h = pad(d.getHours());
  const min = pad(d.getMinutes());
  const s = pad(d.getSeconds());
  return `${y}.${m}.${day}. ${h}:${min}:${s}`;
 }

async function fetchLastFeed({id, read_key}) {
  const keyParam = read_key ? `&api_key=${read_key}` : "";
  const url = `https://api.thingspeak.com/channels/${id}/feeds/last.json?${keyParam}`;
  const res = await fetch(url);
  if (!res.ok) throw new Error(`HTTP ${res.status}`);
  return res.json();
 }

async function update() {
  try {
    const [g1, g2, g3, g4, n1, n2, n3, n4] = await Promise.all([
      fetchLastFeed(CHANNELS.gma1), 
      fetchLastFeed(CHANNELS.gma2),
      fetchLastFeed(CHANNELS.gma3), 
      fetchLastFeed(CHANNELS.gma4),
      fetchLastFeed(CHANNELS.naver1),
      fetchLastFeed(CHANNELS.naver2),     
      fetchLastFeed(CHANNELS.naver3),     
      fetchLastFeed(CHANNELS.naver4),     
    ]);

    // ì˜¨ì‹¤g1
    qsel("g1_lux").textContent  = ` ğŸ’¡ì¡°ëª…: ${Math.round(+g1.field1||0)} Lux`;
    qsel("g1_temp").textContent = ` ğŸŒ¡ï¸ì˜¨ë„: ${(+g1.field2||0).toFixed(1)} â„ƒ`;
    qsel("g1_hum").textContent  = ` ğŸ’§ìŠµë„: ${Math.round(+g1.field3||0)} %`;
    qsel("g1_time").textContent = `ì—…ë°ì´íŠ¸: ${fmtDateTime(g1.created_at)}`;
    
    // ì‚¬ë¬´ì‹¤g2
    qsel("g2_lux").textContent  = ` ğŸ’¡ì¡°ëª…: ${Math.round(+g2.field1||0)} Lux`;
    qsel("g2_temp").textContent = ` ğŸŒ¡ï¸ì˜¨ë„: ${(+g2.field2||0).toFixed(1)} â„ƒ`;
    qsel("g2_hum").textContent  = ` ğŸ’§ìŠµë„: ${Math.round(+g2.field3||0)} %`;
    qsel("g2_time").textContent = `ì—…ë°ì´íŠ¸: ${fmtDateTime(g2.created_at)}`; 

    // ì§‘g3
    qsel("g3_lux").textContent  = ` ğŸ’¡ì¡°ëª…: ${Math.round(+g3.field1||0)} Lux`;
    qsel("g3_temp").textContent = ` ğŸŒ¡ï¸ì˜¨ë„: ${(+g3.field2||0).toFixed(1)} â„ƒ`;
    qsel("g3_hum").textContent  = ` ğŸ’§ìŠµë„: ${Math.round(+g3.field3||0)} %`;
    qsel("g3_time").textContent = `ì—…ë°ì´íŠ¸: ${fmtDateTime(g3.created_at)}`;

    // ë² ë€ë‹¤g4
    qsel("g4_lux").textContent  = ` ğŸ’¡ì¡°ëª…: ${Math.round(+g4.field1||0)} Lux`;
    qsel("g4_temp").textContent = ` ğŸŒ¡ï¸ì˜¨ë„: ${(+g4.field2||0).toFixed(1)} â„ƒ`;
    qsel("g4_hum").textContent  = ` ğŸ’§ìŠµë„: ${Math.round(+g4.field3||0)} %`;
    qsel("g4_time").textContent = `ì—…ë°ì´íŠ¸: ${fmtDateTime(g4.created_at)}`;
    
    // ë„¤ì´ë²„n1
    qsel("n1_lux").textContent  = ` ğŸ’¡ì¡°ëª…: ${Math.round(+n1.field1||0)} Lux`;
    qsel("n1_temp").textContent = ` ğŸŒ¡ï¸ì˜¨ë„: ${(+n1.field2||0).toFixed(1)} â„ƒ`;
    qsel("n1_hum").textContent  = ` ğŸ’§ìŠµë„: ${Math.round(+n1.field3||0)} %`;
    qsel("n1_time").textContent = ` update: ${fmtDateTime(n1.created_at)}`;
        
    //ë„¤ì´ë²„n2
    qsel("n2_lux").textContent  = ` ğŸ’¡ì¡°ëª…: ${Math.round(+n2.field1||0)} Lux`;
    qsel("n2_temp").textContent = ` ğŸŒ¡ï¸ì˜¨ë„: ${(+n2.field2||0).toFixed(1)} â„ƒ`;
    qsel("n2_hum").textContent  = ` ğŸ’§ìŠµë„: ${Math.round(+n2.field3||0)} %`;
    qsel("n2_time").textContent = ` update: ${fmtDateTime(n2.created_at)}`;
            
    // ë„¤ì´ë²„n3
    qsel("n3_lux").textContent  = ` ğŸ’¡ì¡°ëª…: ${Math.round(+n3.field1||0)} Lux`;
    qsel("n3_temp").textContent = ` ğŸŒ¡ï¸ì˜¨ë„: ${(+n3.field2||0).toFixed(1)} â„ƒ`;
    qsel("n3_hum").textContent  = ` ğŸ’§ìŠµë„: ${Math.round(+n3.field3||0)} %`;
    qsel("n3_time").textContent = ` update: ${fmtDateTime(n3.created_at)}`;
            
    // ë„¤ì´ë²„n4
    qsel("n4_lux").textContent  = ` ğŸ’¡ì¡°ëª…: ${Math.round(+n4.field1||0)} Lux`;
    qsel("n4_temp").textContent = ` ğŸŒ¡ï¸ì˜¨ë„: ${(+n4.field2||0).toFixed(1)} â„ƒ`;
    qsel("n4_hum").textContent  = ` ğŸ’§ìŠµë„: ${Math.round(+n4.field3||0)} %`;
    qsel("n4_time").textContent = ` update: ${fmtDateTime(n4.created_at)}`;

  } catch (e) {
    console.log("ì—…ë°ì´íŠ¸ ì˜¤ë¥˜:", e);  }
}

function tickClock() {
  qsel("clock").textContent = fmtClockTime();
}

setInterval(tickClock, 1000);
tickClock();

update();
setInterval(update, 10000);
</script>
  
</body>
</html>










